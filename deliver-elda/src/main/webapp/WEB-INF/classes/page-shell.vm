<html>
#parse("page-head-shell.vm")
<body>

<img src="/elda/lda-assets/images/elda-banner.png" alt="Elda banner" />

<header>
	<h1>Linked Data API</h1>
</header>

#macro (tag, $property, $value)
    "Select items with $property.shortForm() less than $value"
#end

#macro (selection, $prefix, $symbol, $wording, $property, $value)					
    <a
    	title="Select items with $property.shortForm() $wording $value"
    	href="$thisPage.change($prefix, $property, $value).getURI()"
    > 
    	$symbol 
    </a>
#end

#macro(nesting, $item)
	#foreach ($property in $item.properties)
		<hr style="color: #fff">
		<div class="indented">
			<a href="$property.URI">$property.label.cut()</a>
			#set ($values = ${item.getValues($property)})
			#if ($values.size() < 2) #else #end
			#foreach ($value in ${item.getValues($property)})
				<div class="indented">
					#if ($value.justALabel)
						<a href="$value.URI">$value.label</a>
					#else
						<div style="float: left"> $value.shortForm().cut() </div>
						
						#if ($value.isLiteral())
							<div style="float: right; margin-right: 1ex">
								#selection("maxEx-", "&lt;", "less than", $property, $value)
								#selection("max-", "&le;", "less or equal to", $property, $value)
								#selection("", "=", "equal to", $property, $value)
								#selection("min-", "&ge;", "greater or equal to", $property, $value)
								#selection("minEx-", "&gt;", "greater than", $property, $value)
							</div>
						#end
						
						<div style="clear: both"> </div>
						
						#if ($value.isResource()) #nesting($value) #end
					#end
				</div>
			#end
		</div>
	#end
#end

<table>
<tr>
<td width="80%">

	<div width="100%" id="search-results">
		<h1>Search Results</h1>
		
		#foreach ($item in $items) 
			<div class="itembox">
			<h2><a href="$item.URI" id="$item.id">$item.label</a></h2>
			#nesting($item)
			</div>
		#end
	</div>
	
</td>
<td valign="top" width="20%">
	<div>
		<div>
			<div style="margin-top: 3ex" class="right-header">formats</div>
			<div class="indented" style="margin-top: 1ex; margin-bottom: 1ex">
				#foreach ($f in $formats)
					<a href="$f.link">$f.name</a>
				#end
			</div>
		</div>
		
		<div class="bordered-panel">
			<div class="right-header">on this page</div>
			#foreach ($item in $items)
				<div style="margin-left: 1ex">&raquo; <a href="#$item.id">$item.label</a></div>
			#end
		</div>
	
	</div>

</td>
</tr>
</table>


<textarea class="provenance" name="query" style="width: 45%">
$meta['selectionResult.query.value']
</textarea>

#parse("page-foot-shell.vm")

</body>
</html>